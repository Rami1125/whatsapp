<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ח.סבן חומרי בניין - קטלוג מקצועי</title>
    <!-- ייבוא פונט Rubik לשיפור הקריאות והתאמה למראה המודרני -->
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <!-- ייבוא Font Awesome לאייקונים -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* הגדרת משתני CSS עבור צבעים ואנימציות */
        :root {
            --primary: #25D366; /* ירוק ווטסאפ */
            --primary-dark: #128C7E; /* ירוק ווטסאפ כהה */
            --accent: #FFD700; /* זהב/צהוב הדגשה */
            --neon-blue: #00f2ff;
            --neon-green: #00ff9d;
            --neon-orange: #ff7b00;
            --neon-purple: #bd00ff;
            --neon-red: #ff0055;
            --neon-yellow: #ffee00;
            --neon-cyan: #00eeff;
            --neon-magenta: #ff00ee;
            --neon-lime: #aaff00;
            --light-bg: #f9f9f9; /* רקע בהיר מאוד */
            --card-light: #ffffff; /* רקע כרטיס בהיר */
            --border-light: rgba(0, 0, 0, 0.1); /* גבול בהיר */
            --text-dark: #333333; /* טקסט כהה על רקע בהיר */
            --shadow-light: rgba(0, 0, 0, 0.08); /* צל בהיר ועדין */
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); /* מעבר חלק */
            --light-blue: #e0f2f7; /* כחול בהיר חדש */
            --subtle-blue-accent: #a7d9ed; /* גוון כחול עדין יותר */
        }

        /* איפוס ברירות מחדל של דפדפן */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* עיצוב גוף הדף - רקע בהיר */
        body {
            font-family: 'Rubik', sans-serif;
            background-color: var(--light-bg);
            color: var(--text-dark);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 10px;
        }

        /* קונטיינר ראשי המדמה מסך טאבלט */
        .tablet-container {
            width: 100%;
            max-width: 1024px; /* רוחב מקסימלי לטאבלט */
            min-height: calc(100vh - 20px);
            display: flex;
            flex-direction: column; /* תוכן בעמודה */
            background: var(--card-light);
            border-radius: 25px;
            box-shadow: 0 15px 30px var(--shadow-light);
            border: 1px solid var(--border-light);
            position: relative;
            overflow: hidden;
        }

        /* כותרת עליונה/באנר */
        .header-banner {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.6));
            border-bottom: 1px solid var(--border-light);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            backdrop-filter: blur(8px);
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-logo {
            height: 50px;
            width: 50px;
            background-image: url('https://i.postimg.cc/NjhWzHjM/1000101077.jpg'); /* לוגו ח.סבן */
            background-size: cover;
            background-position: center;
            border-radius: 50%;
            border: 2px solid var(--accent);
            box-shadow: 0 0 8px rgba(255, 215, 0, 0.3);
        }

        .header-title {
            font-size: 28px;
            font-weight: 800;
            color: var(--text-dark);
            text-shadow: 0 0 3px rgba(0,0,0,0.05);
            margin-right: auto; /* דחיפה לימין ב-RTL */
            padding-right: 20px;
        }

        /* כפתור תפריט ראשי */
        .main-menu-btn {
            background-color: var(--primary);
            color: white;
            padding: 12px 20px;
            border-radius: 15px;
            border: none;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main-menu-btn i {
            margin-left: 10px;
            font-size: 1.1em;
        }

        .main-menu-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        /* תפריט ניווט נפתח (זהה לקודם אך מופעל מכפתור אחר) */
        .nav-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: flex-end;
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }

        .nav-overlay.show {
            opacity: 1;
            pointer-events: all;
        }

        .nav-menu {
            background: var(--card-light);
            width: 70%;
            max-width: 300px;
            height: 100%;
            padding: 30px 20px;
            box-shadow: -5px 0 20px rgba(0,0,0,0.3);
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
        }

        .nav-overlay.show .nav-menu {
            transform: translateX(0);
        }

        .nav-menu ul {
            list-style: none;
            padding: 0;
            margin-top: 20px;
        }

        .nav-menu ul li {
            margin-bottom: 15px;
        }

        .nav-menu ul li a {
            display: block;
            padding: 12px 15px;
            background-color: rgba(0, 0, 0, 0.03);
            border-radius: 12px;
            text-decoration: none;
            color: var(--text-dark);
            font-weight: 600;
            font-size: 17px;
            transition: var(--transition);
            display: flex;
            align-items: center;
        }

        .nav-menu ul li a i {
            margin-left: 10px;
            color: var(--primary);
        }

        .nav-menu ul li a:hover {
            background-color: rgba(0, 0, 0, 0.08);
            transform: translateX(-5px);
            color: var(--primary-dark);
        }

        .nav-menu .close-nav {
            align-self: flex-start;
            background: none;
            border: none;
            font-size: 30px;
            color: #666;
            cursor: pointer;
            transition: var(--transition);
            padding: 5px;
        }

        .nav-menu .close-nav:hover {
            color: var(--text-dark);
            transform: rotate(90deg);
        }

        /* אזור התוכן הראשי */
        .main-content-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* כפתורי ניווט ראשיים - גריד */
        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); /* כפתורים גדולים יותר */
            gap: 20px;
            margin-bottom: 40px;
            width: 100%;
            max-width: 900px; /* הגבלת רוחב הגריד */
        }

        /* עיצוב כפתורים - מרובעים, גדולים, אפקט הברקה */
        .btn {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 25px; /* ריפוד גדול יותר */
            border-radius: 18px; /* פינות מעוגלות */
            background: rgba(255, 255, 255, 0.7); /* רקע זכוכית בהיר */
            border: 1px solid;
            color: var(--text-dark);
            font-weight: 600;
            text-decoration: none;
            transition: var(--transition);
            box-shadow: 0 8px 20px var(--shadow-light), inset 0 0 5px rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(10px);
            min-height: 120px; /* גובה מינימלי גדול יותר */
            cursor: pointer;
            overflow: hidden;
            z-index: 1;
            text-align: center;
        }

        /* אפקט הברקה על ריחוף */
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: skewX(-20deg);
            transition: all 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15), inset 0 0 8px rgba(255, 255, 255, 0.7);
        }

        /* אייקון בתוך הכפתור */
        .btn-icon {
            font-size: 32px; /* גודל אייקון גדול יותר */
            margin-bottom: 12px;
            transition: var(--transition);
            filter: drop-shadow(0 0 3px rgba(0,0,0,0.2));
        }

        .btn:hover .btn-icon {
            transform: scale(1.2);
            filter: drop-shadow(0 0 6px var(--accent));
        }

        /* טקסט הכפתור */
        .btn-text {
            font-size: 16px;
            font-weight: 700;
            text-align: center;
            line-height: 1.3;
            text-shadow: 0 0 3px rgba(0,0,0,0.1);
        }

        /* צבעי ניאון לכפתורים */
        .btn-primary { border-color: var(--neon-blue); box-shadow: 0 0 15px rgba(0, 242, 255, 0.3); }
        .btn-primary:hover { box-shadow: 0 0 25px rgba(0, 242, 255, 0.6); }
        .btn-secondary { border-color: var(--neon-green); box-shadow: 0 0 15px rgba(0, 255, 157, 0.3); }
        .btn-secondary:hover { box-shadow: 0 0 25px rgba(0, 255, 157, 0.6); }
        .btn-orange { border-color: var(--neon-orange); box-shadow: 0 0 15px rgba(255, 123, 0, 0.3); }
        .btn-orange:hover { box-shadow: 0 0 25px rgba(255, 123, 0, 0.6); }
        .btn-purple { border-color: var(--neon-purple); box-shadow: 0 0 15px rgba(189, 0, 255, 0.3); }
        .btn-purple:hover { box-shadow: 0 0 25px rgba(189, 0, 255, 0.6); }
        .btn-accent { border-color: var(--accent); box-shadow: 0 0 15px rgba(255, 215, 0, 0.3); }
        .btn-accent:hover { box-shadow: 0 0 25px rgba(255, 215, 0, 0.6); }
        .btn-whatsapp { border-color: var(--primary); box-shadow: 0 0 15px rgba(37, 211, 102, 0.3); }
        .btn-whatsapp:hover { box-shadow: 0 0 25px rgba(37, 211, 102, 0.6); }
        .btn-neon-red { border-color: var(--neon-red); box-shadow: 0 0 15px rgba(255, 0, 85, 0.3); }
        .btn-neon-red:hover { box-shadow: 0 0 25px rgba(255, 0, 85, 0.6); }
        .btn-neon-yellow { border-color: var(--neon-yellow); box-shadow: 0 0 15px rgba(255, 238, 0, 0.3); }
        .btn-neon-yellow:hover { box-shadow: 0 0 25px rgba(255, 238, 0, 0.6); }
        .btn-neon-cyan { border-color: var(--neon-cyan); box-shadow: 0 0 15px rgba(0, 238, 255, 0.3); }
        .btn-neon-cyan:hover { box-shadow: 0 0 25px rgba(0, 238, 255, 0.6); }
        .btn-neon-magenta { border-color: var(--neon-magenta); box-shadow: 0 0 15px rgba(255, 0, 238, 0.3); }
        .btn-neon-magenta:hover { box-shadow: 0 0 25px rgba(255, 0, 238, 0.6); }
        .btn-neon-lime { border-color: var(--neon-lime); box-shadow: 0 0 15px rgba(170, 255, 0, 0.3); }
        .btn-neon-lime:hover { box-shadow: 0 0 25px rgba(170, 255, 0, 0.6); }

        /* סקשן "אולי יעניין אותך" - המלצות AI */
        .recommended-section {
            background: rgba(0, 0, 0, 0.03);
            border-radius: 20px;
            padding: 20px;
            margin-top: 25px;
            margin-bottom: 40px; /* הוספת מרווח תחתון לפני הסקשן החדש */
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            width: 100%;
            max-width: 900px;
        }

        .recommended-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--neon-purple);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .recommended-title i {
            margin-left: 10px;
            font-size: 20px;
        }

        .recommended-products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }

        .recommended-product-item {
            background: var(--card-light);
            border-radius: 15px;
            padding: 10px;
            border: 1px solid rgba(0,0,0,0.05);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-align: center;
            font-size: 13px;
            color: var(--text-dark);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .recommended-product-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            background: rgba(0,0,0,0.03);
        }

        /* סקשן "מוצרים חדשים" - קרוסלה */
        .new-products-section {
            background: linear-gradient(135deg, var(--light-blue), var(--card-light));
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 40px;
            border: 1px solid var(--subtle-blue-accent);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 900px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .new-products-header {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }

        .new-products-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--neon-blue);
            text-decoration: none;
            display: flex;
            align-items: center;
            transition: var(--transition);
            text-shadow: 0 0 5px rgba(0, 242, 255, 0.2);
        }

        .new-products-title:hover {
            color: var(--neon-cyan);
            transform: translateY(-2px);
            text-shadow: 0 0 8px rgba(0, 242, 255, 0.4);
        }

        .new-products-title i {
            margin-left: 10px;
            font-size: 24px;
        }

        .carousel-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* רוחב מקסימלי לקרוסלה */
            margin: 0 auto;
            overflow: hidden;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            border: 1px solid rgba(255,255,255,0.5);
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(5px);
        }

        .carousel-images {
            display: flex;
            transition: transform 0.5s ease-in-out;
            border-radius: 15px;
        }

        .carousel-image-wrapper {
            min-width: 100%;
            box-sizing: border-box;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            border-radius: 15px;
        }

        .carousel-image {
            width: 100%;
            height: 250px; /* גובה קבוע לתמונות */
            object-fit: cover; /* מילוי עם חיתוך */
            border-radius: 15px;
            transition: transform 0.3s ease-in-out;
        }

        .carousel-image-wrapper:hover .carousel-image {
            transform: scale(1.05);
        }

        /* אפקט הברקה על תמונות הקרוסלה */
        .carousel-image-wrapper::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transform: skewX(-20deg);
            transition: all 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            pointer-events: none; /* כדי לא לחסום קליקים */
        }

        .carousel-image-wrapper:hover::before {
            left: 100%;
        }

        .carousel-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: var(--primary-dark);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: var(--transition);
            z-index: 10;
        }

        .carousel-nav-btn:hover {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transform: translateY(-50%) scale(1.1);
        }

        .carousel-nav-btn.prev {
            right: 10px;
        }

        .carousel-nav-btn.next {
            left: 10px;
        }

        .carousel-dots {
            display: flex;
            justify-content: center;
            margin-top: 15px;
            gap: 8px;
        }

        .dot {
            width: 10px;
            height: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .dot.active {
            background: var(--primary);
            transform: scale(1.2);
        }

        /* תיבת התכתבות מדמה וואטסאפ */
        .whatsapp-chat-container {
            position: fixed; /* שינוי ל-fixed */
            bottom: 20px;
            right: 20px;
            width: 380px; /* רוחב קבוע */
            height: 500px; /* גובה קבוע */
            background: rgba(255, 255, 255, 0.9); /* רקע בהיר יותר */
            border-radius: 20px;
            padding: 20px;
            border: 1px solid var(--border-light);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(15px); /* טשטוש חזק יותר */
            display: flex;
            flex-direction: column;
            z-index: 1001; /* מעל כל הפופאפים הרגילים */
            transform: translateY(100%); /* מוסתר בהתחלה */
            opacity: 0;
            transition: transform 0.4s ease-out, opacity 0.4s ease-out;
        }

        .whatsapp-chat-container.show {
            transform: translateY(0);
            opacity: 1;
        }

        .chat-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .chat-avatar {
            width: 50px;
            height: 50px;
            background-image: url('https://i.postimg.cc/NjhWzHjM/1000101077.jpg'); /* לוגו ח.סבן כאווטאר */
            background-size: cover;
            background-position: center;
            border-radius: 50%;
            border: 2px solid var(--primary);
            margin-left: 15px;
        }

        .chat-info h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .chat-info p {
            font-size: 14px;
            color: #666;
        }

        .close-chat-btn {
            position: absolute;
            top: 0;
            left: 0;
            background: none;
            border: none;
            font-size: 24px;
            color: #666;
            cursor: pointer;
            transition: var(--transition);
            padding: 5px;
            border-radius: 50%;
        }

        .close-chat-btn:hover {
            color: var(--text-dark);
            transform: scale(1.2);
            background: rgba(0,0,0,0.05);
        }

        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) rgba(0,0,0,0.1);
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.05);
            border-radius: 10px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background-color: var(--primary);
            border-radius: 10px;
        }

        .chat-message {
            max-width: 80%;
            padding: 12px 18px;
            border-radius: 18px;
            font-size: 15px;
            line-height: 1.5;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: relative; /* למיקום אווטאר */
        }

        .user-message {
            background-color: #e2fddf; /* ירוק בהיר */
            align-self: flex-end; /* יישור לימין ב-RTL */
            color: var(--text-dark);
            border-bottom-right-radius: 4px;
            margin-right: 55px; /* מקום לאווטאר */
        }

        .agent-message {
            background-color: #f0f0f0; /* אפור בהיר */
            align-self: flex-start; /* יישור לשמאל ב-RTL */
            color: var(--text-dark);
            border-bottom-left-radius: 4px;
            margin-left: 55px; /* מקום לאווטאר */
        }

        .message-avatar {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-size: cover;
            background-position: center;
            border: 2px solid;
            bottom: 0;
        }

        .user-message .message-avatar {
            right: -45px; /* מיקום אווטאר הלקוח */
            border-color: #ccc;
            background-color: #eee; /* רקע גנרי לאווטאר לקוח */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #888;
        }

        .agent-message .message-avatar {
            left: -45px; /* מיקום אווטאר הנציגה */
            border-color: var(--primary);
            background-image: url('https://i.postimg.cc/NjhWzHjM/1000101077.jpg'); /* לוגו ח.סבן כאווטאר נציגה */
        }

        .chat-input-area {
            display: flex;
            flex-direction: column; /* כפתורים מעל השדה */
            gap: 10px;
            padding-top: 15px;
            border-top: 1px solid rgba(0,0,0,0.08);
            margin-top: 15px;
        }

        .chat-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }

        .chat-suggestion-btn {
            background: rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 12px;
            padding: 8px 12px;
            font-size: 13px;
            color: var(--text-dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .chat-suggestion-btn:hover {
            background: rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .chat-input-row {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex-grow: 1;
            padding: 12px 20px;
            border-radius: 25px;
            border: 1px solid rgba(0,0,0,0.1);
            background: rgba(0,0,0,0.03);
            font-size: 16px;
            color: var(--text-dark);
            outline: none;
            transition: var(--transition);
        }

        .chat-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 8px rgba(37, 211, 102, 0.2);
        }

        .chat-send-btn {
            background: var(--primary);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }

        .chat-send-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* סקשן שאלות נפוצות */
        .faq-section {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            padding: 25px;
            margin-top: 40px;
            border: 1px solid var(--border-light);
            box-shadow: 0 8px 25px var(--shadow-light);
            backdrop-filter: blur(10px);
            width: 100%;
            max-width: 900px;
        }

        .faq-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .faq-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--neon-cyan);
            display: flex;
            align-items: center;
        }

        .faq-title i {
            margin-left: 12px;
            font-size: 24px;
        }

        .faq-search-input {
            width: 100%;
            padding: 12px 20px;
            border-radius: 25px;
            border: 1px solid rgba(0,0,0,0.1);
            background: rgba(0,0,0,0.03);
            font-size: 16px;
            color: var(--text-dark);
            outline: none;
            transition: var(--transition);
            margin-bottom: 20px;
        }

        .faq-search-input:focus {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 8px rgba(0, 238, 255, 0.2);
        }

        .faq-item {
            background: rgba(0, 0, 0, 0.03);
            border-radius: 15px;
            margin-bottom: 10px;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
            transition: var(--transition);
        }

        .faq-question {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            font-size: 16px;
            font-weight: 600;
            color: var(--text-dark);
            cursor: pointer;
            transition: var(--transition);
        }

        .faq-question:hover {
            background: rgba(0, 0, 0, 0.06);
        }

        .faq-question i {
            margin-left: 10px;
            transition: transform 0.3s ease;
        }

        .faq-question.active i {
            transform: rotate(90deg);
        }

        .faq-answer {
            padding: 0 20px 15px;
            font-size: 15px;
            color: #555;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out, padding 0.4s ease-out;
            background-color: rgba(0,0,0,0.01);
            display: flex;
            flex-direction: column;
            gap: 10px; /* רווח בין התשובה לכפתור */
        }

        .faq-answer.show {
            max-height: 200px; /* גובה מקסימלי לתשובה */
            padding: 0 20px 20px;
        }

        .faq-answer .send-new-question-btn {
            background: var(--primary);
            color: white;
            padding: 8px 15px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px; /* רווח מעל הכפתור */
            align-self: flex-start; /* יישור לימין ב-RTL */
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .faq-answer .send-new-question-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }


        /* חלון קופץ לטופס פנייה דינאמי (שימוש חוזר ב-messagePopup) */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            backdrop-filter: blur(10px);
        }

        .popup-overlay.show {
            opacity: 1;
            pointer-events: all;
        }

        .popup-container {
            background: var(--card-light);
            border-radius: 25px;
            width: 95%;
            max-width: 550px; /* רוחב גדול יותר לטופס */
            padding: 30px;
            box-shadow: 0 0 25px rgba(0, 0, 0, 0.2);
            transform: translateY(50px) scale(0.9);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), opacity 0.4s ease-out;
            border: 1px solid var(--border-light);
            backdrop-filter: blur(8px);
            position: relative;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .popup-overlay.show .popup-container {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .popup-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--accent);
            display: flex;
            align-items: center;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.2);
        }

        .popup-title i {
            margin-left: 12px;
            font-size: 24px;
        }

        .close-popup {
            background: none;
            border: none;
            color: #666;
            font-size: 28px;
            cursor: pointer;
            transition: var(--transition);
            padding: 5px;
            border-radius: 50%;
        }

        .close-popup:hover {
            color: var(--text-dark);
            transform: scale(1.2) rotate(90deg);
            background: rgba(0,0,0,0.05);
        }

        .popup-content {
            flex-grow: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent) rgba(0,0,0,0.1);
            padding-right: 5px;
        }

        .popup-content::-webkit-scrollbar {
            width: 6px;
        }

        .popup-content::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.05);
            border-radius: 10px;
        }

        .popup-content::-webkit-scrollbar-thumb {
            background-color: var(--accent);
            border-radius: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .form-group input[type="text"],
        .form-group input[type="tel"],
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.03);
            color: var(--text-dark);
            font-size: 15px;
            transition: var(--transition);
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            outline: none;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            background: rgba(0, 0, 0, 0.08);
            box-shadow: 0 0 8px rgba(0,0,0,0.1), inset 0 0 5px rgba(0,0,0,0.03);
            border-color: var(--neon-blue);
        }

        .form-summary {
            background: rgba(37, 211, 102, 0.08);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            border: 1px solid rgba(37, 211, 102, 0.2);
            font-size: 15px;
            line-height: 1.6;
            color: var(--text-dark);
        }

        .form-summary h4 {
            font-size: 16px;
            color: var(--primary-dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .form-summary h4 i {
            margin-left: 8px;
        }

        .form-summary p {
            margin-bottom: 5px;
        }

        .popup-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .popup-btn {
            flex: 1;
            padding: 14px;
            border-radius: 15px;
            border: none;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            font-size: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .popup-btn i {
            margin-left: 8px;
            font-size: 1.1em;
        }

        .popup-btn-copy {
            background: rgba(0, 0, 0, 0.08);
            color: var(--text-dark);
            border: 1px solid rgba(0, 0, 0, 0.15);
        }

        .popup-btn-copy:hover {
            background: rgba(0, 0, 0, 0.12);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .popup-btn-send {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .popup-btn-send:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        /* חלון קופץ לסניפים */
        .branch-card {
            background: var(--card-light);
            border-radius: 20px;
            margin-bottom: 25px;
            border: 1px solid var(--border-light);
            box-shadow: 0 8px 25px var(--shadow-light);
            overflow: hidden;
            color: var(--text-dark);
        }

        .branch-map {
            height: 200px;
            width: 100%;
            border: none;
            display: block;
        }

        .branch-info {
            padding: 25px;
        }

        .branch-name {
            font-size: 20px;
            font-weight: 700;
            color: #004d40;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
        }

        .branch-name i {
            margin-left: 10px;
            font-size: 22px;
            color: var(--accent);
        }

        .branch-detail {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            font-size: 15px;
            line-height: 1.6;
        }

        .branch-detail i {
            margin-left: 12px;
            color: #00796b;
            min-width: 20px;
            font-size: 1.1em;
        }

        .branch-detail a {
            color: #005f52;
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .branch-detail a:hover {
            color: #004d40;
            text-decoration: underline;
        }

        .branch-button {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            padding: 14px;
            margin-top: 20px;
            border-radius: 15px;
            text-decoration: none;
            font-weight: 700;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: none;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .branch-button i {
            margin-left: 10px;
            font-size: 1.2em;
        }

        .branch-button:hover {
            background: linear-gradient(135deg, #2E7D32, #4CAF50);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        /* דף קטגוריה */
        .category-page {
            display: none;
            flex-direction: column;
            width: 100%;
            height: 100%;
            padding: 30px;
            background: var(--card-light);
            border-radius: 24px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
            overflow-y: auto;
            position: absolute; /* כדי לכסות את המסך הראשי */
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 40; /* מעל המסך הראשי, מתחת לתפריט/פופאפים */
        }

        .category-page.show {
            display: flex;
        }

        .category-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .category-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .back-to-home {
            background: rgba(0,0,0,0.05);
            border: none;
            color: var(--text-dark);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .back-to-home:hover {
            background: rgba(0,0,0,0.1);
            transform: scale(1.1);
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); /* כרטיסים גדולים יותר */
            gap: 20px;
            padding-bottom: 20px;
            width: 100%;
        }

        .product-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 18px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border: 1px solid rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: var(--transition);
            position: relative;
            backdrop-filter: blur(5px);
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }

        .product-image {
            width: 120px; /* תמונות גדולות יותר */
            height: 120px;
            object-fit: contain;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .product-name {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .product-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .order-product-btn {
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 12px;
            text-decoration: none;
            font-size: 15px;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            width: 100%;
        }

        .order-product-btn i {
            margin-left: 8px;
        }

        .order-product-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.03);
        }

        .favorite-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255,255,255,0.7);
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            color: #ccc;
            transition: var(--transition);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .favorite-btn.active {
            color: var(--neon-red);
        }

        .favorite-btn:hover {
            background: rgba(255,255,255,0.9);
            transform: scale(1.1);
        }

        /* סקשן פתיחה (Splash Screen) */
        .splash-screen-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 1;
            transition: opacity 1s ease-out;
        }

        .splash-screen-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            text-align: center;
        }

        .splash-whatsapp-logo {
            font-size: 80px;
            animation: pulse 1.5s infinite ease-in-out;
            margin-bottom: 20px;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 0.8; }
        }

        .splash-text {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 30px;
        }

        .splash-countdown { /* סגנון חדש לספירה לאחור */
            font-size: 48px;
            font-weight: 900;
            color: var(--accent);
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            margin-top: 20px;
            opacity: 0;
            animation: fadeIn 0.5s forwards 0.5s;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        .chat-intro-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 90%;
            max-width: 350px;
            color: var(--text-dark);
            transform: translateY(20px);
            opacity: 0;
            animation: slideUpFadeIn 0.8s forwards 1s; /* השהייה לפני הופעה */
        }

        @keyframes slideUpFadeIn {
            to { transform: translateY(0); opacity: 1; }
        }

        .intro-avatar {
            width: 70px;
            height: 70px;
            background-image: url('https://i.postimg.cc/NjhWzHjM/1000101077.jpg');
            background-size: cover;
            background-position: center;
            border-radius: 50%;
            border: 3px solid var(--primary);
            margin-bottom: 15px;
        }

        .intro-agent-name {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 5px;
        }

        .intro-status {
            font-size: 14px;
            color: #555;
            margin-bottom: 20px;
        }

        .intro-message {
            font-size: 16px;
            text-align: center;
            margin-bottom: 25px;
            color: #444;
        }

        .start-chat-btn {
            background: var(--primary);
            color: white;
            padding: 12px 25px;
            border-radius: 15px;
            border: none;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .start-chat-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        /* חלון קופץ חכם לנציגה */
        .agent-popup-overlay {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000; /* מתחת לצ'אט עצמו */
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease-out;
        }

        .agent-popup {
            background-image: url('https://media.easy.co.il/images/UserPics/3380331_1716100444367.jpeg'); /* תמונת רקע חדשה */
            background-size: cover;
            background-position: center;
            background-color: rgba(255, 255, 255, 0.8); /* רקע שקוף למחצה */
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 15px;
            width: 320px;
            border: 1px solid var(--border-light);
            backdrop-filter: blur(8px); /* טשטוש על התמונה שמאחור */
            position: relative;
        }

        .agent-popup-avatar {
            width: 80px; /* גודל גדול יותר */
            height: 80px; /* גודל גדול יותר */
            border-radius: 50%;
            background-image: url('https://ylt.co.il/wp-content/uploads/2021/08/smiling-woman-headset-presentation-something.jpg');
            background-size: cover;
            background-position: center;
            border: 3px solid var(--primary); /* עובי בורדר גדול יותר */
        }

        .agent-popup-content {
            flex-grow: 1;
        }

        .agent-popup-text {
            font-size: 15px;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .agent-popup-btn {
            background: var(--primary);
            color: white;
            padding: 8px 15px;
            border-radius: 10px;
            border: none;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }

        .agent-popup-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .agent-popup-timer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: rgba(0,0,0,0.1);
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            overflow: hidden;
        }

        .agent-popup-timer-fill {
            height: 100%;
            background: var(--accent);
            width: 100%;
            transition: width linear;
        }

        /* רספונסיביות למסכים קטנים (טלפון) */
        @media (max-width: 768px) {
            .tablet-container {
                border-radius: 0; /* ללא פינות מעוגלות בטלפון */
                min-height: 100vh;
                padding: 0;
            }

            .header-banner {
                padding: 15px 20px;
                flex-wrap: wrap; /* לאפשר גלישה לשורה הבאה */
            }

            .header-title {
                font-size: 22px;
                padding-right: 10px;
                margin-right: 0;
                width: 100%; /* תופס את כל הרוחב */
                text-align: center;
                margin-top: 10px;
            }

            .header-logo {
                height: 40px;
                width: 40px;
            }

            .main-menu-btn {
                padding: 10px 15px;
                font-size: 14px;
                margin-right: auto; /* דחיפה לימין */
            }

            .main-content-area {
                padding: 20px;
            }

            .buttons-grid {
                grid-template-columns: 1fr; /* עמודה אחת במובייל */
                gap: 15px;
            }

            .btn {
                padding: 18px;
                min-height: 100px;
                border-radius: 15px;
            }

            .btn-icon {
                font-size: 28px;
                margin-bottom: 10px;
            }

            .btn-text {
                font-size: 15px;
            }

            .whatsapp-chat-container {
                width: calc(100% - 40px); /* רוחב מלא בטלפון */
                height: 80vh; /* גובה יחסי */
                bottom: 10px;
                right: 10px;
                left: 10px;
                margin: auto;
            }

            .chat-header {
                margin-bottom: 15px;
                padding-bottom: 10px;
            }

            .chat-avatar {
                width: 40px;
                height: 40px;
                margin-left: 10px;
            }

            .chat-info h3 {
                font-size: 16px;
            }

            .chat-info p {
                font-size: 13px;
            }

            .chat-message {
                padding: 10px 15px;
                font-size: 14px;
                margin-right: 45px; /* מקום לאווטאר */
                margin-left: 45px; /* מקום לאווטאר */
            }

            .user-message .message-avatar {
                right: -40px;
            }

            .agent-message .message-avatar {
                left: -40px;
            }

            .chat-input-area {
                padding-top: 10px;
                margin-top: 10px;
            }

            .chat-input {
                padding: 10px 15px;
                font-size: 14px;
            }

            .chat-send-btn {
                width: 40px;
                height: 40px;
            }

            .faq-section {
                padding: 20px;
            }

            .faq-title {
                font-size: 20px;
            }

            .faq-search-input {
                padding: 10px 15px;
                font-size: 14px;
            }

            .faq-question {
                padding: 12px 18px;
                font-size: 15px;
            }

            .faq-answer {
                padding: 0 18px 15px;
                font-size: 14px;
            }

            .popup-container {
                padding: 25px 20px;
                border-radius: 20px;
            }

            .popup-title {
                font-size: 20px;
            }

            .close-popup {
                font-size: 26px;
            }

            .form-group input, .form-group textarea {
                padding: 10px 12px;
                font-size: 14px;
            }

            .popup-actions {
                flex-direction: column;
                gap: 10px;
            }

            .popup-btn {
                padding: 12px;
                font-size: 14px;
            }

            .branch-card {
                border-radius: 18px;
            }

            .branch-map {
                height: 180px;
            }

            .branch-info {
                padding: 20px;
            }

            .branch-name {
                font-size: 18px;
            }

            .branch-detail {
                font-size: 14px;
            }

            .branch-button {
                padding: 12px;
                font-size: 15px;
            }

            .category-page {
                padding: 20px;
            }

            .category-title {
                font-size: 24px;
            }

            .product-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 15px;
            }

            .product-card {
                padding: 15px;
            }

            .product-image {
                width: 100px;
                height: 100px;
            }

            .product-name {
                font-size: 16px;
            }

            .product-description {
                font-size: 13px;
            }

            .order-product-btn {
                font-size: 14px;
                padding: 8px 15px;
            }

            .splash-whatsapp-logo {
                font-size: 60px;
            }

            .splash-text {
                font-size: 20px;
            }

            .chat-intro-box {
                padding: 20px;
                max-width: 300px;
            }

            .intro-avatar {
                width: 60px;
                height: 60px;
            }

            .intro-agent-name {
                font-size: 18px;
            }

            .intro-status {
                font-size: 13px;
            }

            .start-chat-btn {
                padding: 10px 20px;
                font-size: 15px;
            }

            .agent-popup {
                width: calc(100% - 40px);
                left: 10px;
                right: 10px;
                margin: auto;
            }
        }
    </style>
</head>
<body>
    <!-- סקשן פתיחה (Splash Screen) -->
    <div class="splash-screen-overlay" id="splashScreen">
        <div class="splash-screen-content">
            <i class="fab fa-whatsapp splash-whatsapp-logo"></i>
            <div class="splash-text">
                ברוכים הבאים ל<br>ח.סבן חומרי בניין
            </div>
            <!-- אלמנט חדש לספירה לאחור -->
            <div class="splash-countdown" id="splashCountdown">3</div>
            <div class="chat-intro-box">
                <div class="intro-avatar"></div>
                <div class="intro-agent-name">נציג שירות</div>
                <div class="intro-status">זמין כעת</div>
                <div class="intro-message">
                    שלום 👋 איך אפשר לעזור לך?
                </div>
                <button class="start-chat-btn" id="startChatBtn">התכתב עם נציג</button>
            </div>
        </div>
    </div>

    <!-- קונטיינר ראשי המדמה מסך טאבלט -->
    <div class="tablet-container" id="tabletContainer" style="display: none;">
        <!-- כותרת עליונה/באנר -->
        <div class="header-banner">
            <div class="header-logo"></div>
            <h1 class="header-title">ח.סבן חומרי בניין</h1>
            <button class="main-menu-btn" id="mainMenuBtn">
                <i class="fas fa-bars"></i>
                מחלקות ח.סבן
            </button>
        </div>

        <!-- אזור התוכן הראשי -->
        <div class="main-content-area" id="mainContentArea">
            <!-- כפתורי ניווט ראשיים - גריד עם עיצוב משודרג -->
            <div class="buttons-grid">
                <a href="https://rami1125.github.io/Saban94/" class="btn btn-primary" target="_blank">
                    <i class="fas fa-bolt btn-icon"></i>
                    <div class="btn-text">הזמנה מהירה</div>
                </a>

                <a href="https://did.li/fwj6q" class="btn btn-secondary" target="_blank">
                    <i class="fas fa-pencil-ruler btn-icon"></i>
                    <div class="btn-text">טופס הצטרפות לקוח</div>
                </a>

                <button class="btn btn-neon-red" data-initial-message="שלום, מעוניין להזמין מנוף.">
                    <i class="fas fa-truck-loading btn-icon"></i>
                    <div class="btn-text">הזמנת מנוף</div>
                </button>

                <button class="btn btn-neon-yellow" data-initial-message="שלום, מעוניין להזמין משאית.">
                    <i class="fas fa-truck-moving btn-icon"></i>
                    <div class="btn-text">הזמנת משאית</div>
                </button>

                <button class="btn btn-neon-cyan" data-initial-message="שלום, מעוניין להציב מכולה.">
                    <i class="fas fa-dumpster btn-icon"></i>
                    <div class="btn-text">הצבת מכולה</div>
                </button>

                <a href="https://did.li/8B3TY" class="btn btn-orange" target="_blank">
                    <i class="fas fa-trash-alt btn-icon"></i>
                    <div class="btn-text">פינוי פסולת</div>
                </a>

                <button class="btn btn-neon-magenta" data-initial-message="שלום, מעוניין בפרטים על חומרי בניין.">
                    <i class="fas fa-hard-hat btn-icon"></i>
                    <div class="btn-text">חומרי בניין</div>
                </button>

                <button class="btn btn-neon-lime" data-initial-message="שלום, מעוניין בפרטים על מוצרי איטום.">
                    <i class="fas fa-tint btn-icon"></i>
                    <div class="btn-text">מוצרי איטום</div>
                </button>

                <button class="btn btn-primary" data-initial-message="שלום, מעוניין בפרטים על צבעים וכלים סניטריים.">
                    <i class="fas fa-paint-roller btn-icon"></i>
                    <div class="btn-text">צבעים וכלים סניטריים</div>
                </button>

                <button class="btn btn-secondary" data-initial-message="שלום, מעוניין בפרטים על מרצפות ועץ לבניין.">
                    <i class="fas fa-tree btn-icon"></i>
                    <div class="btn-text">מרצפות ועץ לבניין</div>
                </button>

                <button class="btn btn-orange" data-initial-message="שלום, מעוניין בפרטים על חומרי ניקיון במבצע.">
                    <i class="fas fa-broom btn-icon"></i>
                    <div class="btn-text">חומרי ניקיון במבצע</div>
                </button>

                <a href="https://did.li/BVEZH" class="btn btn-purple" target="_blank">
                    <i class="fas fa-hard-hat btn-icon"></i>
                    <div class="btn-text">ייעוץ מקצועי</div>
                </a>

                <button class="btn btn-accent" id="branchesBtn">
                    <i class="fas fa-map-marker-alt btn-icon"></i>
                    <div class="btn-text">סניפים</div>
                </button>

                <button class="btn btn-whatsapp" id="contactBtn">
                    <i class="fab fa-whatsapp btn-icon"></i>
                    <div class="btn-text">צור קשר</div>
                </button>
            </div>

            <!-- סקשן "אולי יעניין אותך" - המלצות AI -->
            <div class="recommended-section">
                <div class="recommended-title">
                    <i class="fas fa-lightbulb"></i>
                    אולי יעניין אותך
                </div>
                <div class="recommended-products-grid" id="recommendedProducts">
                    <!-- המלצות יוצגו כאן דינמית -->
                </div>
            </div>

            <!-- סקשן "מוצרים חדשים" - קרוסלה מתחלפת -->
            <div class="new-products-section">
                <div class="new-products-header">
                    <a href="#" class="new-products-title" id="newProductsLink">
                        <i class="fas fa-box-open"></i>
                        מוצרים חדשים
                    </a>
                </div>
                <div class="carousel-container">
                    <div class="carousel-images" id="carouselImages">
                        <!-- תמונות יוצגו כאן דינמית -->
                    </div>
                    <button class="carousel-nav-btn prev" id="carouselPrevBtn"><i class="fas fa-chevron-right"></i></button>
                    <button class="carousel-nav-btn next" id="carouselNextBtn"><i class="fas fa-chevron-left"></i></button>
                    <div class="carousel-dots" id="carouselDots">
                        <!-- נקודות ניווט יוצגו כאן דינמית -->
                    </div>
                </div>
            </div>

            <!-- סקשן שאלות נפוצות -->
            <div class="faq-section">
                <div class="faq-header">
                    <h2 class="faq-title">
                        <i class="fas fa-question-circle"></i>
                        שאלות נפוצות
                    </h2>
                </div>
                <input type="text" class="faq-search-input" id="faqSearchInput" placeholder="חפש שאלה...">
                <div class="faq-list" id="faqList">
                    <!-- שאלות ותשובות יוצגו כאן -->
                </div>
            </div>
        </div>

        <!-- דפי קטגוריות (יוספו דינמית) -->
        <div id="categoryPagesContainer"></div>
    </div>

    <!-- תיבת התכתבות מדמה וואטסאפ -->
    <div class="whatsapp-chat-container" id="whatsappChatContainer">
        <div class="chat-header">
            <button class="close-chat-btn" id="closeChatBtn">×</button>
            <div class="chat-avatar"></div>
            <div class="chat-info">
                <h3>מחלקת שירות לקוחות</h3>
                <p>זמין כעת</p>
            </div>
        </div>
        <div class="chat-messages" id="chatMessages">
            <!-- הודעות צ'אט יוצגו כאן -->
            <div class="chat-message agent-message">
                שלום 👋 איך אפשר לעזור לך?
                <div class="message-avatar"></div>
            </div>
        </div>
        <div class="chat-input-area">
            <div class="chat-suggestions" id="chatSuggestions">
                <!-- הצעות יופיעו כאן -->
            </div>
            <div class="chat-input-row">
                <input type="text" class="chat-input" placeholder="כתוב הודעה..." id="chatInput">
                <button class="chat-send-btn" id="chatSendBtn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- כפתור WhatsApp קבוע - פותח את תיבת הצ'אט -->
    <button class="fixed-whatsapp-btn" id="openChatBtn">
        <i class="fab fa-whatsapp"></i>
    </button>

    <!-- חלון קופץ לטופס פנייה דינאמי -->
    <div class="popup-overlay" id="messagePopup">
        <div class="popup-container">
            <div class="popup-header">
                <div class="popup-title">
                    <i class="fas fa-envelope"></i>
                    שלח פנייה
                </div>
                <button class="close-popup" id="closePopup">×</button>
            </div>

            <div class="popup-content">
                <div class="form-group">
                    <label for="formNameInput">שם מלא:</label>
                    <input type="text" id="formNameInput" placeholder="הכנס/י שם מלא" autocomplete="name">
                </div>
                <div class="form-group">
                    <label for="formPhoneInput">טלפון:</label>
                    <input type="tel" id="formPhoneInput" placeholder="הכנס/י מספר טלפון" autocomplete="tel">
                </div>
                <div class="form-group">
                    <label for="formSubjectInput">נושא הפנייה:</label>
                    <input type="text" id="formSubjectInput" placeholder="לדוגמה: הזמנת מלט, שאלה על מחיר" autocomplete="on">
                </div>
                <div class="form-group">
                    <label for="formMessageInput">שאלה / בקשה:</label>
                    <textarea id="formMessageInput" placeholder="פרט/י את שאלתך או בקשתך כאן..."></textarea>
                </div>

                <div class="form-summary" id="formSummary">
                    <h4><i class="fas fa-clipboard-list"></i> סיכום הפנייה:</h4>
                    <p id="summaryName">שם: </p>
                    <p id="summaryPhone">טלפון: </p>
                    <p id="summarySubject">נושא: </p>
                    <p id="summaryMessage">בקשה: </p>
                </div>
            </div>

            <div class="popup-actions">
                <button class="popup-btn popup-btn-copy" id="copyFormMessageBtn">
                    העתק הודעה
                    <i class="far fa-copy"></i>
                </button>
                <button class="popup-btn popup-btn-send" id="sendFormWhatsappBtn">
                    שלח לוואטסאפ
                    <i class="fab fa-whatsapp"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- חלון קופץ לסניפים -->
    <div class="popup-overlay" id="branchesPopup">
        <div class="popup-container">
            <div class="popup-header">
                <div class="popup-title">
                    <i class="fas fa-map-marked-alt"></i>
                    סניפי החברה
                </div>
                <button class="close-popup" id="closeBranchesPopup">×</button>
            </div>

            <div class="popup-content">
                <!-- כרטיס סניף התלמיד 6 -->
                <div class="branch-card">
                    <iframe class="branch-map" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3364.3245342509334!2d34.89983887573536!3d32.15740511747278!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x151d38257da6385b%3A0x34b1c300a0e4570b!2z15zXqNeZINeo15XXmdeaINeV16HXmdeZICzXldeq15nXlCDXqtei16jXmdeU16jXldec15Qg15XXl9eU!5e0!3m2!1sen!2sil!4v1707823456789" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    <div class="branch-info">
                        <h3 class="branch-name">
                            <i class="fas fa-store"></i>
                            סניף הוד השרון - התלמיד 6
                        </h3>
                        <div class="branch-detail">
                            <i class="fas fa-phone"></i>
                            <span>טלפון: <a href="tel:09-7602010">09-7602010</a></span>
                        </div>
                        <div class="branch-detail">
                            <i class="fas fa-clock"></i>
                            <span>שעות פעילות: א'-ה': 06:00-18:00, ו': 06:00-14:00</span>
                        </div>
                        <div class="branch-detail">
                            <i class="fas fa-truck"></i>
                            <span>שירות הובלות: עד 500 טון, מנופים עד 100 מטר</span>
                        </div>
                        <button class="branch-button" onclick="window.open('https://www.google.com/maps/dir/?api=1&destination=32.1574051,34.9024138', '_blank')">
                            <span>נווט לסניף</span>
                            <i class="fas fa-directions"></i>
                        </button>
                    </div>
                </div>
                <!-- כרטיס סניף החרש 10 -->
                <div class="branch-card">
                    <iframe class="branch-map" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3364.3288500412585!2d34.8998426155857!3d32.15720128011981!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x151d382571234567%3A0xa1b2c3d4e5f67890!2sHaHarash%2010%2C%20Hod%20HaSharon!5e0!3m2!1sen!2sil!4v1707823456789" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    <div class="branch-info">
                        <h3 class="branch-name">
                            <i class="fas fa-store"></i>
                            סניף הוד השרון - החרש 10
                        </h3>
                        <div class="branch-detail">
                            <i class="fas fa-phone"></i>
                            <span>טלפון: <a href="tel:09-7402575">09-7402575</a></span>
                        </div>
                        <div class="branch-detail">
                            <i class="fas fa-clock"></i>
                            <span>שעות פעילות: א'-ה': 06:30-16:00, ו': 06:30-13:30</span>
                        </div>
                        <div class="branch-detail">
                            <i class="fas fa-warehouse"></i>
                            <span>איסוף עצמי: חומרים לכל סוגי הבנייה</span>
                        </div>
                        <button class="branch-button" onclick="window.open('https://www.google.com/maps/dir/?api=1&destination=32.1572013,34.9020174', '_blank')">
                            <span>נווט לסניף</span>
                            <i class="fas fa-directions"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- חלון קופץ חכם לנציגה -->
    <div class="agent-popup-overlay" id="agentPopupOverlay">
        <div class="agent-popup">
            <div class="agent-popup-avatar"></div>
            <div class="agent-popup-content">
                <div class="agent-popup-text">
                    שלום! אני כאן לכל שאלה - רוצה עזרה במציאת מוצר?
                </div>
                <button class="agent-popup-btn" id="openChatFromPopupBtn">
                    פתח תפריט
                </button>
            </div>
            <div class="agent-popup-timer">
                <div class="agent-popup-timer-fill" id="agentPopupTimerFill"></div>
            </div>
        </div>
    </div>

    <!-- תפריט ניווט נפתח -->
    <div class="nav-overlay" id="navOverlay">
        <div class="nav-menu">
            <button class="close-nav" id="closeNav">×</button>
            <ul>
                <li><a href="#" data-category="חשמל"><i class="fas fa-lightbulb"></i> חשמל</a></li>
                <li><a href="#" data-category="חומרי בניין"><i class="fas fa-hard-hat"></i> חומרי בניין</a></li>
                <li><a href="#" data-category="כלי עבודה"><i class="fas fa-tools"></i> כלי עבודה</a></li>
                <li><a href="#" data-category="מחלקת צבע"><i class="fas fa-paint-brush"></i> מחלקת צבע</a></li>
                <li><a href="#" data-category="ציוד בטיחות"><i class="fas fa-shield-alt"></i> ציוד בטיחות</a></li>
                <li><a href="#" data-category="מחלקת גינה"><i class="fas fa-leaf"></i> מחלקת גינה</a></li>
                <li><a href="#" data-category="שירותי הובלה"><i class="fas fa-truck"></i> שירותי הובלה</a></li>
                <li><a href="#" data-category="סניפים" id="navBranchesBtn"><i class="fas fa-map-marker-alt"></i> סניפים</a></li>
            </ul>
        </div>
    </div>

    <script>
        // נתוני מוצרים לדוגמה (יוחלפו בנתונים אמיתיים)
        const productsData = {
            "חשמל": [
                { id: "e1", name: "מנעול חכם Linus® L2 מבית YALE!", description: "פתיחה אוטומטית ללא מפתח - עם קודן או טביעת אצבע 🔑🖐️", image: "https://gw-assets.assaabloy.com/is/image/assaabloy/5052847131336.PT03-20?wid=1520" },
                { id: "e2", name: "שקע כפול גוויס", description: "שקע חשמל כפול איכותי להתקנה בקיר.", image: "https://d3m9l0v76dty0.cloudfront.net/system/photos/14257848/large/75048cebc446ce5d37f46fa818aa00f5.jpeg" },
                { id: "e3", name: "מפסק תאורה", description: "מפסק לדוד חשמל, תאורה ועוד.", image: "https://d3m9l0v76dty0.cloudfront.net/system/photos/6518728/large/8b8660dd841cce0f1c43f63d324f2871.jpg" },
                { id: "e4", name: "לוח חשמל 12 מקום", description: "לוח חשמל תקני לדירות ומשרדים קטנים.", image: "https://d3m9l0v76dty0.cloudfront.net/system/photos/13898653/large/51b09d54003405406700bcd5890948a9.jpg" },
                { id: "e5", name: "נורות לד חסכוניות", description: "מארז 5 נורות לד E27 חסכוניות באנרגיה.", image: "https://d3m9l0v76dty0.cloudfront.net/system/photos/7199759/extra_large/248ac70909c5ffd31474fa1625887625.jpg" },
                { id: "e6", name: "פס צבירה לתאורה", description: "פס צבירה דקורטיבי לתאורת ספוטים.", image: "https://www.peleg4home.com/wp-content/uploads/2022/02/4.png" }
            ],
            "חומרי בניין": [
                { id: "b1", name: "בטון מוכן 25 ק\"ג", description: "שק בטון מוכן איכותי לבנייה.", image: "https://marzevit.co.il/wp-content/uploads/2020/05/fe84e8babcbd6108c37de4084610afa1.jpg" },
                { id: "b2", name: "חול בלה (חצי קוב)", description: "בלה חול", image: "https://probuilder.co.il/wp-content/uploads/2021/11/%D7%91%D7%9C%D7%94-%D7%97%D7%95%D7%9C-%D7%99%D7%9D-%D7%96%D7%99%D7%A4%D7%96%D7%99%D7%A3-%D7%A9%D7%A7-%D7%A2%D7%A0%D7%A7.png" },
                { id: "b3", name: "בלוק פומיס", description: "בלוק פומיס קל ואיכותי לבניית קירות.", image: "https://probuilder.co.il/wp-content/uploads/2025/01/%D7%91%D7%9C%D7%95%D7%A7-%D7%A4%D7%95%D7%9E%D7%99%D7%A1-%D7%91%D7%A0%D7%99%D7%99%D7%94-%D7%9E%D7%91%D7%98%D7%95%D7%9F-%D7%98%D7%A8%D7%9E%D7%95%D7%93%D7%9F.png" },
                { id: "b4", name: "מוצרי איטום", description: "מוצרי איטום של סיקה", image: "https://better4u.co.il/wp-content/uploads/2021/01/sika-logo.png" }
            ],
            "כלי עבודה": [
                { id: "t1", name: "פטיש 5 ק\"ג", description: "פטיש כבד לעבודות הריסה ובנייה.", image: "https://zurmarket.co.il/cdn/shop/files/51fLQVbi5EL._AC_SL1500.jpg?v=1749121553&width=1946" },
                { id: "t2", name: "מקדחה רוטטת", description: "מקדחה מקצועית לקידוח בבטון ועץ.", image: "https://d3m9l0v76dty0.cloudfront.net/system/photos/11268082/large/44ba92ae69c8e38578d169a71a247471.webp" },
                { id: "t3", name: "מפתח שוודי", description: "מפתח שוודי מתכוונן בגדלים שונים.", image: "https://www.boombam.co.il/wp-content/uploads/2023/01/FHAW106810-Fixtec-600x723.png" },
                { id: "t4", name: "מסור חשמלי", description: "מסור חשמלי לחיתוך עץ ומתכת.", image: "https://d3m9l0v76dty0.cloudfront.net/system/photos/12677192/large/ec45040bf9ca9312ef41d8f7f8770e1f.png" },
                { id: "t5", name: "דיסקית חיתוך יהלום", description: "דיסקית איכותית לחיתוך בטון ואבן.", image: "https://www.boombam.co.il/wp-content/uploads/2023/03/%D7%93%D7%99%D7%A1%D7%A7-%D7%97%D7%99%D7%AA%D7%95%D7%9A-CGW-9.jpg" },
                { id: "t6", name: "מברגה חשמלית", description: "מברגה נטענת לעבודות הרכבה ופירוק.", image: "https://img.kwcdn.com/product/fancy/ffb19af5-f9be-4d7d-9bcd-10799fcf1336.jpg?imageView2/2/w/800/q/70/format/webp" }
            ],
            "מחלקת צבע": [
                { id: "p1", name: "צבע אקרילי לבן", description: "צבע אקרילי איכותי לקירות פנים.", image: "https://placehold.co/120x120/f0f0f0/333333?text=צבע+לבן" },
                { id: "p2", name: "פריימר לקירות", description: "חומר מקשר לפני צביעה לשיפור אחיזה.", image: "https://placehold.co/120x120/f0f0f0/333333?text=פריימר" },
                { id: "p3", name: "רולר צבע", description: "רולר איכותי לצביעה אחידה ומהירה.", image: "https://placehold.co/120x120/f0f0f0/333333?text=רולר" },
                { id: "p4", name: "מגש צבע", description: "מגש פלסטיק נוח לשימוש עם רולר.", image: "https://placehold.co/120x120/f0f0f0/333333?text=מגש+צבע" },
                { id: "p5", name: "שליכט צבעוני", description: "שליכט אקרילי גמיש במגוון צבעים.", image: "https://placehold.co/120x120/f0f0f0/333333?text=שליכט" },
                { id: "p6", name: "צבע טמבור קירות", description: "צבע איכותי של טמבור לקירות פנים וחוץ.", image: "https://placehold.co/120x120/f0f0f0/333333?text=טמבור" },
                { id: "p7", name: "צבע אפוקסי לרצפה", description: "צבע אפוקסי עמיד במיוחד לרצפות תעשייתיות.", image: "https://placehold.co/120x120/f0f0f0/333333?text=אפוקסי" },
                { id: "p8", name: "ספריי צבע שחור", description: "צבע ספריי מהיר ייבוש למתכת ועץ.", image: "https://placehold.co/120x120/f0f0f0/333333?text=ספריי" }
            ],
            "ציוד בטיחות": [
                { id: "s1", name: "קסדת בטיחות", description: "קסדה קשיחה להגנה על הראש באתרי בנייה.", image: "https://placehold.co/120x120/f0f0f0/333333?text=קסדה" },
                { id: "s2", name: "כפפות עבודה", description: "כפפות עמידות להגנה על הידיים.", image: "https://placehold.co/120x120/f0f0f0/333333?text=כפפות" },
                { id: "s3", name: "נעלי בטיחות", description: "נעליים עם כיפת מגן להגנה על כפות הרגליים.", image: "https://placehold.co/120x120/f0f0f0/333333?text=נעלי+בטיחות" },
                { id: "s4", name: "אפוד זוהר", description: "אפוד זוהר לנראות גבוהה בשטח.", image: "https://placehold.co/120x120/f0f0f0/333333?text=אפוד+זוהר" }
            ],
            "מחלקת גינה": [
                { id: "g1", name: "מכסחת דשא", description: "מכסחת דשא חשמלית קלה ונוחה לשימוש.", image: "https://placehold.co/120x120/f0f0f0/333333?text=מכסחת" },
                { id: "g2", name: "צינור השקיה 20 מ'", description: "צינור השקיה גמיש ועמיד לגינה.", image: "https://placehold.co/120x120/f0f0f0/333333?text=צינור" },
                { id: "g3", name: "מזמרה", description: "מזמרה חדה ואיכותית לגיזום עצים ושיחים.", image: "https://placehold.co/120x120/f0f0f0/333333?text=מזמרה" },
                { id: "g4", name: "דשן נוזלי", description: "דשן נוזלי מרוכז לדישון צמחי גינה.", image: "https://placehold.co/120x120/f0f0f0/333333?text=דשן" }
            ],
            "שירותי הובלה": [
                { id: "h1", name: "הובלת מלט (טון)", description: "הובלת מלט עד 10 טון לאתר הלקוח.", image: "https://placehold.co/120x120/f0f0f0/333333?text=הובלת+מלט" },
                { id: "h2", name: "מנוף 20 מטר", description: "שירות מנוף עד גובה 20 מטר להרמת חומרים.", image: "https://placehold.co/120x120/f0f0f0/333333?text=מנוף" },
                { id: "h3", name: "פינוי פסולת 8 קוב", description: "פינוי פסולת בניין במכולה 8 קוב.", image: "https://placehold.co/120x120/f0f0f0/333333?text=פינוי+פסולת" },
                { id: "h4", name: "הובלת חול (קוב)", description: "הובלת חול בכמויות גדולות לאתרי בנייה.", image: "https://placehold.co/120x120/f0f0f0/333333?text=הובלת+חול" }
            ]
        };

        // נתוני שאלות נפוצות
        const faqData = [
            {
                question: "סוגי בלוקים",
                answer: "אנו מספקים מגוון רחב של בלוקים לבנייה, כולל בלוקי בטון, בלוקי איטונג (גז בטון), בלוקי פומיס, ובלוקי איטום. כל סוג מתאים לשימושים שונים, בהתאם לדרישות הפרויקט והתקנים.",
                keywords: ["בלוקים", "איטונג", "בטון", "פומיס", "איטום"]
            },
            {
                question: "הבדלים בין טיט למלט",
                answer: "מלט הוא חומר גלם עיקרי המשמש לייצור בטון וטיט. טיט הוא תערובת של מלט, חול, מים ולעיתים גם סיד, ומשמש בעיקר לחיבור בלוקים, לטיח וריצוף. המלט לבדו אינו משמש לבנייה ישירה.",
                keywords: ["טיט", "מלט", "הבדל טיט מלט", "מה זה טיט", "מה זה מלט"]
            },
            {
                question: "שעות פעילות",
                answer: "שעות הפעילות של סניף התלמיד 6 הוד השרון הן: א'-ה': 06:00-18:00, ו': 06:00-14:00. שעות הפעילות של סניף החרש 10 הוד השרון הן: א'-ה': 06:30-16:00, ו': 06:30-13:30.",
                keywords: ["שעות פתיחה", "שעות פעילות", "מתי פתוח", "סניפים שעות"]
            },
            {
                question: "משלוחים ומינימום הזמנה",
                answer: "אנו מבצעים משלוחים לכל רחבי הארץ. מינימום ההזמנה משתנה בהתאם לסוג החומר ולמרחק המשלוח. מומלץ ליצור קשר עם מחלקת ההזמנות לקבלת פרטים מדויקים עבור ההזמנה שלך.",
                keywords: ["משלוח", "הובלה", "מינימום הזמנה", "עלות משלוח"]
            },
            {
                question: "שירותי מנוף",
                answer: "אנו מציעים שירותי מנוף מתקדמים להרמת חומרים כבדים עד לגובה 100 מטר, וכן שירותי הובלה עם משאיות המסוגלות לשאת עד 500 טון. השירות זמין לכל סוגי הפרויקטים.",
                keywords: ["מנוף", "שירותי מנוף", "הובלות כבדות"]
            },
            {
                question: "חומרים נגד רטיבות",
                answer: "יש לנו מגוון רחב של חומרי איטום מתקדמים למניעת רטיבות, כולל חומרי איטום ביטומניים, צימנטיים, אקריליים ועוד. נשמח לייעץ לך על החומר המתאים ביותר לצורך הספציפי שלך.",
                keywords: ["רטיבות", "איטום", "חומרי איטום", "מים בקיר"]
            },
            {
                question: "סוגי בטון",
                answer: "אנו מספקים בטון מוכן במגוון דרגות חוזק וסוגים, כולל בטון רגיל, בטון קל, בטון בומנייט, ובטון לבן. ניתן להזמין בטון לפי קוב, עם אפשרות למשאבות בטון.",
                keywords: ["בטון", "בטון מוכן", "סוגי בטון", "חוזק בטון"]
            },
            {
                question: "הבדל בין בלוק איטונג לבלוק רגיל",
                answer: "בלוק איטונג (גז בטון) הוא בלוק קל ומבודד תרמית ואקוסטית יותר מבלוק בטון רגיל. הוא עשוי מחומרים נקבוביים ומספק בידוד טוב יותר, אך יקר יותר ודורש שיטות עבודה שונות.",
                keywords: ["איטונג", "בלוק רגיל", "בלוק בטון", "בידוד בלוקים"]
            },
            {
                question: "חומרים מבודדים",
                answer: "אנו מציעים מגוון חומרים לבידוד תרמי ואקוסטי, כגון צמר סלעים, פוליסטירן מוקצף (קלקר), פוליאוריתן, ולוחות גבס עם בידוד. חומרים אלו מסייעים בחיסכון באנרגיה ושיפור נוחות המגורים.",
                keywords: ["בידוד", "חומרי בידוד", "בידוד תרמי", "בידוד אקוסטי"]
            },
            {
                question: "חוקים לגבי בניה עצמית",
                answer: "בנייה עצמית בישראל כפופה לחוקי תכנון ובנייה ותקנות מחמירות. נדרשים היתרי בנייה, תוכניות אדריכליות והנדסיות, פיקוח צמוד, ועמידה בתקני בטיחות. מומלץ להתייעץ עם אנשי מקצוע מוסמכים.",
                keywords: ["בניה עצמית", "חוקי בניה", "היתר בניה", "תקנות בניה"]
            },
            {
                question: "ציוד בטיחות חובה",
                answer: "באופן כללי, ציוד בטיחות חובה באתרי בנייה כולל קסדת בטיחות, נעלי בטיחות עם כיפת מגן, כפפות עבודה, אפוד זוהר, ומשקפי מגן. יש להקפיד על שימוש בציוד תקין ובהתאם להנחיות הבטיחות.",
                keywords: ["ציוד בטיחות", "בטיחות בבניה", "חובה בטיחות", "ציוד מגן"]
            }
        ];

        // נתוני תמונות לקרוסלת "מוצרים חדשים"
        const newProductsImages = [
            { src: "https://gw-assets.assaabloy.com/is/image/assaabloy/5052847131343.PT04-21?wid=3040", alt: "מנעול חכם Linus® L2 מבית Yale" },
            { src: "https://gw-assets.assaabloy.com/is/image/assaabloy/5052847131343.PT04-21?wid=3040", alt: "מנעול חכם Linus® L2 מבית Yale" },
            { src: "https://gw-assets.assaabloy.com/is/image/assaabloy/5052847131336.PT06-21?wid=3040", alt: "מנעול חכם Linus® L2 מבית Yale" },
            { src: "https://gw-assets.assaabloy.com/is/image/assaabloy/5052847131343.MAIN-21?wid=1520", alt: "מנעול חכם Linus® L2 מבית Yale" }
        ];


        // אלמנטים כלליים
        const tabletContainer = document.getElementById('tabletContainer');
        const mainContentArea = document.getElementById('mainContentArea');
        const categoryPagesContainer = document.getElementById('categoryPagesContainer');
        const allButtons = document.querySelectorAll('.btn, .popup-btn, .branch-button, .chat-send-btn, .close-popup, .main-menu-btn, .back-to-home, .order-product-btn, .favorite-btn, .start-chat-btn, .agent-popup-btn, .open-chat-btn');

        // אלמנטים של סקשן פתיחה (Splash Screen)
        const splashScreen = document.getElementById('splashScreen');
        const startChatBtn = document.getElementById('startChatBtn');
        const splashCountdown = document.getElementById('splashCountdown'); // אלמנט חדש לספירה לאחור

        // אלמנטים של תפריט ניווט
        const mainMenuBtn = document.getElementById('mainMenuBtn');
        const navOverlay = document.getElementById('navOverlay');
        const closeNav = document.getElementById('closeNav');
        const navLinks = document.querySelectorAll('.nav-menu ul li a');

        // אלמנטים של חלון קופץ לטופס פנייה (messagePopup משמש כעת לטופס)
        const messagePopup = document.getElementById('messagePopup');
        const closePopup = document.getElementById('closePopup');
        const formNameInput = document.getElementById('formNameInput');
        const formPhoneInput = document.getElementById('formPhoneInput');
        const formSubjectInput = document.getElementById('formSubjectInput');
        const formMessageInput = document.getElementById('formMessageInput');
        const formSummary = document.getElementById('formSummary');
        const summaryName = document.getElementById('summaryName');
        const summaryPhone = document.getElementById('summaryPhone');
        const summarySubject = document.getElementById('summarySubject');
        const summaryMessage = document.getElementById('summaryMessage');
        const copyFormMessageBtn = document.getElementById('copyFormMessageBtn');
        const sendFormWhatsappBtn = document.getElementById('sendFormWhatsappBtn');

        // אלמנטים של סניפים
        const branchesBtn = document.getElementById('branchesBtn');
        const branchesPopup = document.getElementById('branchesPopup');
        const closeBranchesPopup = document.getElementById('closeBranchesPopup');
        const navBranchesBtn = document.getElementById('navBranchesBtn');

        // אלמנטים של צ'אט וואטסאפ מדמה
        const whatsappChatContainer = document.getElementById('whatsappChatContainer');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const chatSendBtn = document.getElementById('chatSendBtn');
        const closeChatBtn = document.getElementById('closeChatBtn');
        const openChatBtn = document.getElementById('openChatBtn');
        const chatSuggestionsContainer = document.getElementById('chatSuggestions');

        // אלמנטים של המלצות AI
        const recommendedProductsContainer = document.getElementById('recommendedProducts');
        let searchHistory = []; // היסטוריית חיפושים/צפיות של המשתמש

        // אלמנטים של שאלות נפוצות
        const faqList = document.getElementById('faqList');
        const faqSearchInput = document.getElementById('faqSearchInput');

        // אלמנטים של קרוסלת מוצרים חדשים
        const carouselImagesContainer = document.getElementById('carouselImages');
        const carouselPrevBtn = document.getElementById('carouselPrevBtn');
        const carouselNextBtn = document.getElementById('carouselNextBtn');
        const carouselDotsContainer = document.getElementById('carouselDots');
        let currentCarouselIndex = 0;
        let carouselInterval;

        // אלמנטים של חלון קופץ חכם לנציגה
        const agentPopupOverlay = document.getElementById('agentPopupOverlay');
        const openChatFromPopupBtn = document.getElementById('openChatFromPopupBtn');
        const agentPopupTimerFill = document.getElementById('agentPopupTimerFill');

        // כתובת קבועה לוואטסאפ
        const WHATSAPP_PHONE_NUMBER = '972547602021'; // מספר טלפון בפורמט בינלאומי ללא +

        // הצעות לשאלות בצ'אט
        const chatSuggestionsData = [
            "מה שעות הפעילות שלכם?",
            "האם יש לכם משלוחים?",
            "אני צריך עזרה עם הזמנה",
            "שאלה לגבי מנוף",
            "האם יש לכם בלוקי איטונג?"
        ];

        // --- פונקציות כלליות ---

        // פונקציית אפקט הקלדה
        function typeMessage(element, text, speed = 40) {
            element.textContent = '';
            let i = 0;
            function type() {
                if (i < text.length) {
                    element.textContent = text.substring(0, i + 1);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }

        // פונקציה להצגת פופאפ
        function showPopup(popupElement) {
            popupElement.classList.add('show');
            adjustPopupHeight();
        }

        // פונקציה להסתרת פופאפ
        function hidePopup(popupElement) {
            popupElement.classList.remove('show');
        }

        // התאמת גובה ה-popup-content לגובה המסך
        function adjustPopupHeight() {
            const popups = document.querySelectorAll('.popup-container');
            popups.forEach(popup => {
                const headerHeight = popup.querySelector('.popup-header') ? popup.querySelector('.popup-header').offsetHeight : 0;
                const actionsHeight = popup.querySelector('.popup-actions') ? popup.querySelector('.popup-actions').offsetHeight : 0;
                const padding = parseInt(window.getComputedStyle(popup).paddingTop) + parseInt(window.getComputedStyle(popup).paddingBottom);
                const availableHeight = window.innerHeight * 0.9 - headerHeight - actionsHeight - padding;
                const popupContent = popup.querySelector('.popup-content');
                if (popupContent) {
                    popupContent.style.maxHeight = `${availableHeight}px`;
                }
            });
        }

        // אנימציות כפתורים בלחיצה ועזיבה
        allButtons.forEach(button => {
            button.addEventListener('mousedown', function() {
                this.style.transform = 'scale(0.95)';
                this.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
            });

            button.addEventListener('mouseup', function() {
                if (button.matches('.btn:hover')) {
                    this.style.transform = 'translateY(-5px) scale(1.02)';
                    this.style.boxShadow = '0 12px 25px rgba(0, 0, 0, 0.15), inset 0 0 8px rgba(255, 255, 255, 0.7)';
                } else if (button.matches('.popup-btn:hover, .branch-button:hover, .chat-send-btn:hover, .order-product-btn:hover, .start-chat-btn:hover, .main-menu-btn:hover, .agent-popup-btn:hover')) {
                    this.style.transform = 'translateY(-2px)';
                } else if (button.matches('.close-popup:hover, .back-to-home:hover, .favorite-btn:hover, .close-chat-btn:hover, #openChatBtn:hover')) {
                    this.style.transform = 'scale(1.1)';
                } else {
                    this.style.transform = 'scale(1)';
                }
            });

            button.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
                this.style.boxShadow = '';
                if (button.matches('.btn')) {
                    this.style.boxShadow = '0 8px 20px rgba(0, 0, 0, 0.1), inset 0 0 5px rgba(255, 255, 255, 0.5)';
                }
            });
        });

        // --- לוגיקת סקשן פתיחה (Splash Screen) ---
        function hideSplashScreen() {
            splashScreen.style.opacity = '0';
            setTimeout(() => {
                splashScreen.style.display = 'none';
                tabletContainer.style.display = 'flex';
                showAgentPopup(); // הצגת הפופאפ של הנציגה לאחר טעינת האתר
            }, 1000); // תואם לזמן המעבר של ה-opacity
        }

        startChatBtn.addEventListener('click', () => {
            hideSplashScreen();
        });

        // פונקציית ספירה לאחור אוטומטית למסך הפתיחה
        function startSplashCountdown(duration = 3) {
            let timeLeft = duration;
            splashCountdown.textContent = timeLeft;
            const countdownInterval = setInterval(() => {
                timeLeft--;
                splashCountdown.textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(countdownInterval);
                    hideSplashScreen();
                }
            }, 1000);
        }


        // --- לוגיקת תפריט ניווט ---
        mainMenuBtn.addEventListener('click', () => {
            navOverlay.classList.add('show');
        });

        closeNav.addEventListener('click', () => {
            navOverlay.classList.remove('show');
        });

        // פונקציה להצגת דף קטגוריה
        function showCategoryPage(categoryName) {
            // הסתרת כל דפי הקטגוריות הקיימים
            document.querySelectorAll('.category-page').forEach(page => page.classList.remove('show'));
            // הסתרת אזור התוכן הראשי
            mainContentArea.style.display = 'none';

            // יצירת דף קטגוריה חדש אם לא קיים
            let categoryPage = document.getElementById(`category-${categoryName.replace(/\s/g, '-')}`);
            if (!categoryPage) {
                categoryPage = document.createElement('div');
                categoryPage.className = 'category-page';
                categoryPage.id = `category-${categoryName.replace(/\s/g, '-')}`;
                categoryPagesContainer.appendChild(categoryPage);
            }

            categoryPage.innerHTML = `
                <div class="category-header">
                    <button class="back-to-home"><i class="fas fa-arrow-right"></i></button>
                    <h2 class="category-title">${categoryName}</h2>
                    <div></div> <!-- Placeholder for alignment -->
                </div>
                <div class="product-grid">
                    <!-- מוצרים יוצגו כאן -->
                </div>
            `;
            categoryPage.classList.add('show');

            const productGrid = categoryPage.querySelector('.product-grid');
            const products = productsData[categoryName] || [];

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.innerHTML = `
                    <button class="favorite-btn" data-product-id="${product.id}"><i class="far fa-heart"></i></button>
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <h3 class="product-name">${product.name}</h3>
                    <p class="product-description">${product.description}</p>
                    <button class="order-product-btn" data-product-name="${product.name}">
                        הזמן עכשיו בוואטסאפ
                        <i class="fab fa-whatsapp"></i>
                    </button>
                `;
                productGrid.appendChild(productCard);

                // הוספת אירוע לחיצה לכפתור ההזמנה
                productCard.querySelector('.order-product-btn').addEventListener('click', function() {
                    const productName = this.getAttribute('data-product-name');
                    const message = `שלום, אני מעוניין להזמין את המוצר: ${productName}. אשמח לפרטים נוספים.`;
                    // פתיחת טופס הפנייה הדינאמי עם הודעה מוגדרת מראש
                    showDynamicContactForm(message);
                });

                // הוספת אירוע לחיצה לכפתור הלב (מועדפים)
                productCard.querySelector('.favorite-btn').addEventListener('click', function() {
                    this.classList.toggle('active');
                    this.querySelector('i').classList.toggle('far');
                    this.querySelector('i').classList.toggle('fas');
                    updateSearchHistory(product.name); // הוספה להיסטוריית חיפושים
                    updateRecommendedProducts(); // עדכון המלצות
                });
            });

            // הוספת אירוע לחיצה לכפתור חזרה לדף הבית בתוך הקטגוריה
            categoryPage.querySelector('.back-to-home').addEventListener('click', () => {
                categoryPage.classList.remove('show');
                mainContentArea.style.display = 'flex';
            });
        }

        // טיפול בלחיצה על קישורי הניווט
        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const category = this.getAttribute('data-category');
                if (category === "סניפים") {
                    showPopup(branchesPopup);
                } else {
                    showCategoryPage(category);
                }
                navOverlay.classList.remove('show'); // סגירת תפריט הניווט
            });
        });

        // --- לוגיקת טופס פנייה דינאמי ---
        function showDynamicContactForm(initialMessage = '') {
            formNameInput.value = '';
            formPhoneInput.value = '';
            formSubjectInput.value = ''; // Reset subject
            formMessageInput.value = initialMessage;

            // Attempt to infer subject from initialMessage if it's empty
            if (initialMessage) {
                if (initialMessage.includes('מנוף')) {
                    formSubjectInput.value = 'הזמנת מנוף';
                } else if (initialMessage.includes('משאית')) {
                    formSubjectInput.value = 'הזמנת משאית';
                } else if (initialMessage.includes('מכולה')) {
                    formSubjectInput.value = 'הצבת מכולה';
                } else if (initialMessage.includes('חומרי בניין')) {
                    formSubjectInput.value = 'שאלה על חומרי בניין';
                } else if (initialMessage.includes('מוצרי איטום')) {
                    formSubjectInput.value = 'שאלה על מוצרי איטום';
                } else if (initialMessage.includes('צבעים')) {
                    formSubjectInput.value = 'שאלה על צבעים';
                } else if (initialMessage.includes('מרצפות') || initialMessage.includes('עץ לבניין')) {
                    formSubjectInput.value = 'שאלה על מרצפות ועץ';
                } else if (initialMessage.includes('ניקיון')) {
                    formSubjectInput.value = 'שאלה על חומרי ניקיון';
                } else if (initialMessage.includes('ייעוץ')) {
                    formSubjectInput.value = 'בקשת ייעוץ מקצועי';
                } else if (initialMessage.includes('הזמנה')) {
                    formSubjectInput.value = 'שאלה/בקשת הזמנה';
                }
            }

            updateFormSummary();
            showPopup(messagePopup);
        }

        // עדכון סיכום הטופס בזמן אמת
        function updateFormSummary() {
            summaryName.textContent = `שם: ${formNameInput.value.trim()}`;
            summaryPhone.textContent = `טלפון: ${formPhoneInput.value.trim()}`;
            summarySubject.textContent = `נושא: ${formSubjectInput.value.trim()}`;
            summaryMessage.textContent = `בקשה: ${formMessageInput.value.trim()}`;
        }

        formNameInput.addEventListener('input', updateFormSummary);
        formPhoneInput.addEventListener('input', updateFormSummary);
        formSubjectInput.addEventListener('input', updateFormSummary);
        formMessageInput.addEventListener('input', updateFormSummary);

        closePopup.addEventListener('click', () => hidePopup(messagePopup));

        // העתקת הודעה מהטופס ללוח הגזירים
        copyFormMessageBtn.addEventListener('click', function() {
            const message = `שם: ${formNameInput.value.trim()}\nטלפון: ${formPhoneInput.value.trim()}\nנושא: ${formSubjectInput.value.trim()}\nבקשה: ${formMessageInput.value.trim()}`;
            const textarea = document.createElement('textarea');
            textarea.value = message;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            this.innerHTML = '<i class="fas fa-check ml-2"></i> הועתק!';
            setTimeout(() => {
                this.innerHTML = 'העתק הודעה <i class="far fa-copy"></i>';
            }, 2000);
        });

        // שליחת הודעה מהטופס לוואטסאפ
        sendFormWhatsappBtn.addEventListener('click', function() {
            const message = `שלום, זו פנייה מהאתר:\nשם: ${formNameInput.value.trim()}\nטלפון: ${formPhoneInput.value.trim()}\nנושא: ${formSubjectInput.value.trim()}\nבקשה: ${formMessageInput.value.trim()}`;

            if (!message.trim()) {
                console.warn('Cannot send empty message to WhatsApp.');
                return;
            }

            const originalText = this.innerHTML;
            this.innerHTML = 'נשלח לוואטסאפ! <i class="fas fa-check"></i>';
            this.style.backgroundColor = 'var(--primary-dark)';
            this.style.boxShadow = '0 0 15px rgba(37, 211, 102, 0.6)';

            const whatsappUrl = `https://wa.me/${WHATSAPP_PHONE_NUMBER}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');

            setTimeout(() => {
                this.innerHTML = originalText;
                this.style.backgroundColor = '';
                this.style.boxShadow = '';
            }, 2000);
        });

        // --- לוגיקת סניפים ---
        branchesBtn.addEventListener('click', () => showPopup(branchesPopup));
        closeBranchesPopup.addEventListener('click', () => hidePopup(branchesPopup));

        // --- לוגיקת צ'אט וואטסאפ מדמה ---
        function addMessageToChat(message, sender) {
            const messageElement = document.createElement('div');
            messageElement.className = `chat-message ${sender}-message`;

            const avatarElement = document.createElement('div');
            avatarElement.className = 'message-avatar';
            if (sender === 'user') {
                avatarElement.innerHTML = '<i class="fas fa-user"></i>';
            }

            messageElement.textContent = message;
            messageElement.appendChild(avatarElement);

            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // הצעות לשאלות בצ'אט
        function renderChatSuggestions() {
            chatSuggestionsContainer.innerHTML = '';
            chatSuggestionsData.forEach(suggestion => {
                const btn = document.createElement('button');
                btn.className = 'chat-suggestion-btn';
                btn.textContent = suggestion;
                btn.addEventListener('click', () => {
                    chatInput.value = suggestion;
                    chatSendBtn.click();
                });
                chatSuggestionsContainer.appendChild(btn);
            });
        }

        chatSendBtn.addEventListener('click', async () => {
            const userMessage = chatInput.value.trim();
            if (userMessage) {
                addMessageToChat(userMessage, 'user');
                chatInput.value = '';

                // ניתוח הודעה והצעת תשובה/הפניה באמצעות AI
                setTimeout(async () => {
                    const prompt = `המשתמש שאל: "${userMessage}". בהתבסס על השאלות הנפוצות הבאות, האם יש תשובה מתאימה?
                    ${JSON.stringify(faqData.map(faq => ({ question: faq.question, answer: faq.answer, keywords: faq.keywords })))}
                    אם יש תשובה מתאימה, החזר רק את התשובה. אם השאלה קשורה להזמנה, מנוף, משאית, מכולה, או פרטים על מוצר, החזר את הטקסט "פתח טופס פנייה". אם השאלה קשורה לסניפים או מיקום, החזר את הטקסט "פתח סניפים". אם לא נמצאה התאמה, החזר את הטקסט "כללי".`;

                    try {
                        const payload = {
                            contents: [{ role: "user", parts: [{ text: prompt }] }],
                            generationConfig: {
                                responseMimeType: "text/plain"
                            }
                        };
                        const apiKey = "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        const result = await response.json();
                        let agentResponseText = 'תודה על פנייתך! נציג שירות יחזור אליך בהקדם.';
                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const aiResponse = result.candidates[0].content.parts[0].text.trim();

                            if (aiResponse.includes("פתח טופס פנייה")) {
                                agentResponseText = 'על מנת לטפל בבקשתך בצורה הטובה ביותר, אנא מלא/י את הטופס הבא:';
                                addMessageToChat(agentResponseText, 'agent');
                                setTimeout(() => showDynamicContactForm(userMessage), 1000);
                                return;
                            } else if (aiResponse.includes("פתח סניפים")) {
                                agentResponseText = 'לפרטי הסניפים שלנו, לחץ/י על כפתור "סניפים" בתפריט הראשי או כאן:';
                                addMessageToChat(agentResponseText, 'agent');
                                setTimeout(() => showPopup(branchesPopup), 1000);
                                return;
                            } else if (aiResponse.includes("כללי")) {
                                agentResponseText = 'תודה על פנייתך! נציג שירות יחזור אליך בהקדם. בינתיים, תוכל/י לשלוח את ההודעה הזו בוואטסאפ:';
                            } else {
                                agentResponseText = aiResponse;
                            }
                        }

                        addMessageToChat(agentResponseText, 'agent');
                        // הצעת כפתור שליחה לוואטסאפ עם כל היסטוריית הצ'אט
                        setTimeout(() => {
                            const shareBtn = document.createElement('button');
                            shareBtn.className = 'popup-btn popup-btn-send';
                            shareBtn.textContent = 'שלח היסטוריית צ\'אט לוואטסאפ';
                            shareBtn.style.width = 'fit-content';
                            shareBtn.style.marginTop = '10px';
                            shareBtn.style.alignSelf = 'center';
                            shareBtn.addEventListener('click', function() {
                                const originalShareText = this.innerHTML;
                                this.innerHTML = 'נשלח לוואטסאפ! <i class="fas fa-check"></i>';
                                this.style.backgroundColor = 'var(--primary-dark)';
                                this.style.boxShadow = '0 0 15px rgba(37, 211, 102, 0.6)';

                                let chatHistoryText = Array.from(chatMessages.children).map(msg => {
                                    const sender = msg.classList.contains('user-message') ? 'אתה' : 'נציג';
                                    const text = msg.textContent.replace('שלח היסטוריית צ\'אט לוואטסאפ', '').trim();
                                    return `${sender}: ${text}`;
                                }).filter(line => line.trim() !== '').join('\n');
                                
                                if (!chatHistoryText.trim()) {
                                    console.warn('Cannot share empty chat history to WhatsApp.');
                                    this.innerHTML = originalShareText;
                                    this.style.backgroundColor = '';
                                    this.style.boxShadow = '';
                                    return;
                                }

                                const whatsappUrl = `https://wa.me/${WHATSAPP_PHONE_NUMBER}?text=${encodeURIComponent("היסטוריית צ'אט מהאתר:\n" + chatHistoryText)}`;
                                window.open(whatsappUrl, '_blank');

                                setTimeout(() => {
                                    this.innerHTML = originalShareText;
                                    this.style.backgroundColor = '';
                                    this.style.boxShadow = '';
                                }, 2000);
                            });
                            chatMessages.appendChild(shareBtn);
                            chatMessages.scrollTop = chatMessages.scrollHeight;
                        }, 500);

                    } catch (error) {
                        console.error('Error fetching AI response:', error);
                        addMessageToChat('אני מתנצל, חלה שגיאה במערכת. נציג שירות יחזור אליך בהקדם.', 'agent');
                    }
                }, 1000);
            }
        });

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                chatSendBtn.click();
            }
        });

        // פתיחת וסגירת תיבת הצ'אט
        openChatBtn.addEventListener('click', () => {
            whatsappChatContainer.classList.add('show');
        });

        closeChatBtn.addEventListener('click', () => {
            whatsappChatContainer.classList.remove('show');
        });

        // --- לוגיקת שאלות נפוצות ---
        function renderFAQs(filter = '') {
            faqList.innerHTML = '';
            // סינון שאלות לפי מילות מפתח או טקסט מלא
            const filteredFaqs = faqData.filter(faq =>
                faq.question.toLowerCase().includes(filter.toLowerCase()) ||
                faq.answer.toLowerCase().includes(filter.toLowerCase()) ||
                (faq.keywords && faq.keywords.some(keyword => keyword.toLowerCase().includes(filter.toLowerCase())))
            );

            filteredFaqs.forEach(faq => {
                const faqItem = document.createElement('div');
                faqItem.className = 'faq-item';
                faqItem.innerHTML = `
                    <div class="faq-question">
                        <span>${faq.question}</span>
                        <i class="fas fa-chevron-left"></i>
                    </div>
                    <div class="faq-answer">
                        <p>${faq.answer}</p>
                        <button class="send-new-question-btn" data-question-text="${faq.question}">
                            <i class="fas fa-comment-dots"></i> שלח שאלה חדשה לנציג
                        </button>
                    </div>
                `;
                faqList.appendChild(faqItem);

                const questionElement = faqItem.querySelector('.faq-question');
                const answerElement = faqItem.querySelector('.faq-answer');
                const sendNewQuestionBtn = faqItem.querySelector('.send-new-question-btn');

                questionElement.addEventListener('click', () => {
                    questionElement.classList.toggle('active');
                    answerElement.classList.toggle('show');
                });

                // **תיקון: כפתור "שלח שאלה חדשה לנציג" פותח וואטסאפ ישירות**
                sendNewQuestionBtn.addEventListener('click', function() {
                    const questionText = this.getAttribute('data-question-text');
                    const message = `שלום, יש לי שאלה לגבי: "${questionText}". אשמח לקבל עזרה.`;
                    const whatsappUrl = `https://wa.me/${WHATSAPP_PHONE_NUMBER}?text=${encodeURIComponent(message)}`;
                    window.open(whatsappUrl, '_blank');
                    // אין צורך לסגור פופאפ אם לא נפתח
                });
            });
        }

        faqSearchInput.addEventListener('input', (e) => {
            renderFAQs(e.target.value);
        });

        // --- לוגיקת המלצות AI ---
        function updateSearchHistory(item) {
            if (!searchHistory.includes(item)) {
                searchHistory.push(item);
                localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
            }
        }

        function loadSearchHistory() {
            const storedHistory = localStorage.getItem('searchHistory');
            if (storedHistory) {
                searchHistory = JSON.parse(storedHistory);
            }
        }

        async function updateRecommendedProducts() {
            recommendedProductsContainer.innerHTML = '';

            // הגדלת מספר ההמלצות ל-6
            const numberOfRecommendations = 6;

            if (searchHistory.length === 0) {
                const allProductNames = Object.values(productsData).flat().map(p => p.name);
                const randomProducts = allProductNames.sort(() => 0.5 - Math.random()).slice(0, numberOfRecommendations);
                randomProducts.forEach(productName => {
                    const item = document.createElement('div');
                    item.className = 'recommended-product-item';
                    item.textContent = productName;
                    item.addEventListener('click', () => {
                        const message = `שלום, מעוניין בפרטים על: ${productName}.`;
                        showDynamicContactForm(message);
                        updateSearchHistory(productName);
                    });
                    recommendedProductsContainer.appendChild(item);
                });
                return;
            }

            const prompt = `בהתבסס על היסטוריית החיפושים/צפיות של הלקוח: ${searchHistory.join(', ')}.
            הצע ${numberOfRecommendations} מוצרים או קטגוריות נוספות מתוך הרשימה הבאה שעשויים לעניין אותו, פורמט JSON. נסה לגוון את ההמלצות בין מוצרים ספציפיים לקטגוריות כלליות:
            ${JSON.stringify(Object.keys(productsData).concat(Object.values(productsData).flat().map(p => p.name)))}
            הפורמט המבוקש הוא מערך של מחרוזות (שמות מוצרים/קטגוריות).`;

            try {
                const payload = {
                    contents: [{ role: "user", parts: [{ text: prompt }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "ARRAY",
                            items: { "type": "STRING" }
                        }
                    }
                };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const jsonResponse = result.candidates[0].content.parts[0].text;
                    const recommendedItems = JSON.parse(jsonResponse);

                    recommendedItems.forEach(itemText => {
                        const item = document.createElement('div');
                        item.className = 'recommended-product-item';
                        item.textContent = itemText;
                        item.addEventListener('click', () => {
                            const message = `שלום, מעוניין בפרטים על: ${itemText}.`;
                            showDynamicContactForm(message);
                            updateSearchHistory(itemText);
                        });
                        recommendedProductsContainer.appendChild(item);
                    });
                } else {
                    console.error('AI recommendation failed: Unexpected response structure', result);
                    // Fallback to random products if AI fails
                    const allProductNames = Object.values(productsData).flat().map(p => p.name);
                    const randomProducts = allProductNames.sort(() => 0.5 - Math.random()).slice(0, numberOfRecommendations);
                    randomProducts.forEach(productName => {
                        const item = document.createElement('div');
                        item.className = 'recommended-product-item';
                        item.textContent = productName;
                        item.addEventListener('click', () => {
                            const message = `שלום, מעוניין בפרטים על: ${productName}.`;
                            showDynamicContactForm(message);
                            updateSearchHistory(productName);
                        });
                        recommendedProductsContainer.appendChild(item);
                    });
                }
            } catch (error) {
                console.error('Error fetching AI recommendations:', error);
                // Fallback to random products on error
                const allProductNames = Object.values(productsData).flat().map(p => p.name);
                const randomProducts = allProductNames.sort(() => 0.5 - Math.random()).slice(0, numberOfRecommendations);
                randomProducts.forEach(productName => {
                    const item = document.createElement('div');
                    item.className = 'recommended-product-item';
                    item.textContent = productName;
                    item.addEventListener('click', () => {
                        const message = `שלום, מעוניין בפרטים על: ${productName}.`;
                        showDynamicContactForm(message);
                        updateSearchHistory(productName);
                    });
                    recommendedProductsContainer.appendChild(item);
                });
            }
        }

        // --- לוגיקת קרוסלת "מוצרים חדשים" ---
        function renderCarouselImages() {
            carouselImagesContainer.innerHTML = '';
            carouselDotsContainer.innerHTML = '';
            newProductsImages.forEach((image, index) => {
                const wrapper = document.createElement('div');
                wrapper.className = 'carousel-image-wrapper';
                const img = document.createElement('img');
                img.src = image.src;
                img.alt = image.alt;
                img.className = 'carousel-image';
                wrapper.appendChild(img);
                carouselImagesContainer.appendChild(wrapper);

                const dot = document.createElement('div');
                dot.className = 'dot';
                dot.addEventListener('click', () => {
                    moveToSlide(index);
                });
                carouselDotsContainer.appendChild(dot);
            });
            updateCarousel();
        }

        function updateCarousel() {
            const offset = -currentCarouselIndex * 100;
            carouselImagesContainer.style.transform = `translateX(${offset}%)`;

            document.querySelectorAll('.carousel-dots .dot').forEach((dot, index) => {
                if (index === currentCarouselIndex) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }

        function moveToSlide(index) {
            currentCarouselIndex = index;
            if (currentCarouselIndex >= newProductsImages.length) {
                currentCarouselIndex = 0;
            } else if (currentCarouselIndex < 0) {
                currentCarouselIndex = newProductsImages.length - 1;
            }
            updateCarousel();
            resetCarouselInterval();
        }

        carouselPrevBtn.addEventListener('click', () => {
            moveToSlide(currentCarouselIndex + 1); // RTL, so "prev" goes to next index
        });

        carouselNextBtn.addEventListener('click', () => {
            moveToSlide(currentCarouselIndex - 1); // RTL, so "next" goes to previous index
        });

        function startCarouselInterval() {
            carouselInterval = setInterval(() => {
                moveToSlide(currentCarouselIndex + 1);
            }, 5000); // החלפת תמונה כל 5 שניות
        }

        function resetCarouselInterval() {
            clearInterval(carouselInterval);
            startCarouselInterval();
        }

        // --- לוגיקת חלון קופץ חכם לנציגה ---
        function showAgentPopup() {
            // בדוק אם הפופאפ הוצג כבר בסשן הנוכחי
            if (localStorage.getItem('agentPopupShown') === 'true') {
                return;
            }

            agentPopupOverlay.style.opacity = '1';
            agentPopupOverlay.style.pointerEvents = 'all';

            // אנימציית טיימר - **תוקן ל-7 שניות**
            agentPopupTimerFill.style.transition = 'width 7s linear';
            agentPopupTimerFill.style.width = '0%';

            let timer = 7; // **תוקן ל-7 שניות**
            const interval = setInterval(() => {
                timer--;
                if (timer <= 0) {
                    clearInterval(interval);
                    agentPopupOverlay.style.opacity = '0';
                    agentPopupOverlay.style.pointerEvents = 'none';
                    localStorage.setItem('agentPopupShown', 'true'); // סמן שהוצג
                }
            }, 1000);
        }

        openChatFromPopupBtn.addEventListener('click', () => {
            hidePopup(agentPopupOverlay);
            whatsappChatContainer.classList.add('show');
            localStorage.setItem('agentPopupShown', 'true'); // סמן שהוצג
        });


        // --- אתחול האפליקציה ---
        window.addEventListener('load', () => {
            adjustPopupHeight();
            loadSearchHistory();
            updateRecommendedProducts();
            renderFAQs(); // הצגת שאלות נפוצות בטעינה ראשונית
            renderChatSuggestions(); // הצגת הצעות צ'אט
            renderCarouselImages(); // הצגת תמונות הקרוסלה
            startCarouselInterval(); // הפעלת קרוסלה אוטומטית

            // טיפול בכפתורי ההודעות המהירות הקיימים
            document.querySelectorAll('.btn[data-initial-message]').forEach(button => {
                button.addEventListener('click', function() {
                    const initialMessage = this.getAttribute('data-initial-message');
                    showDynamicContactForm(initialMessage);
                });
            });

            // טיפול בכפתור "צור קשר"
            document.getElementById('contactBtn').addEventListener('click', function() {
                showDynamicContactForm("שלום, מעוניין בייעוץ מקצועי לגבי המוצרים והשירותים.");
            });

            // הפעלת הספירה לאחור של מסך הפתיחה
            startSplashCountdown(3); // מתחיל ספירה לאחור מ-3 שניות
        });
    </script>
</body>
</html>
